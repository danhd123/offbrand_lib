
File Structure:
---------------

The OffBrand library is composed of entirely of incomplete types, to create C 
style "classes". Each class is composed of three files:
  - Public Header
  - Private Header
  - Source File
The public header acts as an interface, any declarations in the public header
can be used by any other module. The private header contains the definitions
of the data stored in the incomplete type, and declarations of all private
functions and methods. The source file contains all the definitions for all 
methods declared in either header.

The private header file should only be included by the class source file, no
other classes should have access. This enforces data protection and forces all
data structure allocation on the heap.


Fast Failure:
-------------

When Offbrand library functions fail (due to unexpected input values, failure to
allocate memory, mutex locking issues, etc), they stop the execution of the
entire program. This failure method simplifies the usage of APIs (by greatly
reducing the need for error checking) at the expense of robustness of
performance under all conditions.

Because of this fast failure policy, the library can be used with the assumption
that if a function returns then it succeeded in its task and all return values
are valid.


OffBrand Compatible Class Creation:
-----------------------------------

A OffBrand compatible class should be created using the mkobc (MaKe OffBrand
Class) command included in the installation of the OffBrand library. Run the 
mkobc script with the following syntax:
  $ mkobc <class name>
The command will create three files for the class in the current directory with
some basic boiler plate code already included. DO NOT ALTER THE CODE ALREADY
INCLUDED! The code is essential for creating a class that will work with the
OffBrand framework. All additional code should be added to the created source
files in the appropriate locations, indicated by comments in the files.


obj:
----

obj is the base data type for all OffBrand objects. Casting all OffBrand
compatible instances to obj * allows each data structure to be "generic", where
it can hold instances of any OffBrand compatible type.

obj contains the data for reference counts of all objects and a function
pointer to the destructor function of the class. All obj are initialized with
a reference count of 1 when created, and the destructor for the class is called
automatically when the reference count reaches 0.

To modify the reference count the following methods are defined, which take as
an argument a pointer to any OffBrand class cast to obj *

  obj * release(obj *); Decrements reference count by 1 and frees object if
                        reference count equals 0. Should also call release once
                        on all objs stored within the class if it is a container
  void retain(obj *); Increments reference count by 1

A more detailed description of reference counting code, and a description of
other functions in the Offbrand standard library can be found in "offbrand.h"


Thread Safety:
--------------

Programs wishing to take advantage of the thread synchronization capabilities of
the Offbrand library should include "offbrand_threaded.h" header file rather
than the usual "offbrand.h" file. Programs should also be compiled with the
following gcc flags:
  -lpthread -D OB_THREADED
-lpthread is the usual pthread compilation flag, and -D OB_THREADED defines a
macro that compiles the threaded version of the standard library file(s).

Thread synchronization is not provided by default in Offbrand builtins, these
data structures are non-atomic. Thread synchronization must be enforced manually
by the programmer by using the locking library, described in detail in the
"offbrand_threaded.h" header file.


Contact:
--------

Please send all bug reports, improvements, feedback, etc to:
tyler.heck@gmail.com


